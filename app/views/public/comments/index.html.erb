<% unless @comments.count == 0 %>
<div class = "container">
  <strong><%= @spot.spot_name %></strong>の<strong>口コミ</strong>
  <%= link_to "口コミを投稿する", new_spot_comment_path(@spot.id), class: "btn btn-primary" %>
  <% @comments.each do |comment| %>
    <div class="row">
      <div class="col-md-3">
        <% if comment.customer.image.attached? %>
           <%= image_tag comment.customer.image, size: "250x200" %>
        <% else %>
           <%= image_tag 'no_image', size: "250x200" %>
        <% end %>
        <p><%= comment.customer.name %></p>
      </div>
      <div class="col-md-6 mb-3">
        <div class=" posts-content">
          <h4 class="mb-3">評価：<%= comment.rate %>点 | <%= comment.review %></h4>

        <div id="star-rate-<%= comment.id %>"></div>
          <script>

          $(document).on('turbolinks:load', function() {
          let elem = document.querySelector('#star-rate-<%= comment.id %>');
          if (elem == null) return;

         elem.innerHTML = ""
          let opt = {
          starOn: "<%= asset_path('star-on.png') %>",
          starOff: "<%= asset_path('star-off.png') %>",
          half: false,
          readOnly:true,
          score: <%= comment.rate %>,
          };
          raty(elem, opt);
          });
          </script>

        </div>
      </div>
      <div class="col-md-4">
        <%= comment.review %>
      </div>
      <div class="col-md-12 edit-button">
        <% if comment.customer == current_customer %>
          <%= link_to '口コミを編集', edit_spot_comment_path(@spot, comment), class:'btn btn-default' %>
          <%= link_to '口コミを削除', spot_comment_path(comment.spot, comment), method: :delete, class:'btn btn-default' %>
        <% end %>
      </div>
    </div>
　<% end %>
<% else %>
  <%= link_to "口コミを投稿する", new_spot_comment_path(@spot.id), class: "btn btn-primary" %></p>
  <center>まだ口コミがありません<br>
  口コミ投稿にご協力ください。<br>
  <%= link_to :back do %>
  <button>Back</button>
  <% end %>
  </center>
<% end %>
</div>
